@model KutuphaneUygulamasi.Models.AdminModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Paneli</title>
    <link rel="stylesheet" href="~/css/yeni.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Admin Paneli</h1>

    <div id="menu">
        <button id="add-book-btn">Kitap Ekle</button>
        <button id="list-books-btn">Kitaplarý Listele</button>
        <button id="list-members-btn">Üyeleri Listele</button>
    </div>

    <div id="content">
        <!-- Ýçerik buraya AJAX ile yüklenecek -->
    </div>

    <script>
        $(document).ready(function () {
            function loadPage(action, controller = 'Admin') {
                $.ajax({
                    url: `/${controller}/${action}`,
                    type: 'GET',
                    success: function (result) {
                        $('#content').html(result);
                    },
                    error: function (xhr, status, error) {
                        console.error("Bir hata oluþtu: ", error);
                    }
                });
            }

            // Kitap 
            $('#add-book-btn').click(function () {
                loadPage('AddBook', 'Books');
            });

            // Kitaplarý Listele
            $('#list-books-btn').click(function () {
                loadPage('ListBooks', 'Books');
            });

            // Üyeleri Listele
            $('#list-members-btn').click(function () {
                loadPage('ListMembers');
            });

            // Form gönderme iþlemleri
            $(document).on('submit', '#add-book-form', function (e) {
                e.preventDefault();
                $.ajax({
                    url: '/Books/AddBook',
                    type: 'POST',
                    data: new FormData(this),
                    processData: false,
                    contentType: false,
                    success: function (result) {
                        if (result.success) {
                            alert('Kitap baþarýyla eklendi!');
                            loadPage('ListBooks', 'Books');
                        } else {
                            alert('Bir hata oluþtu: ' + result.errors);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error("Bir hata oluþtu: ", error);
                    }
                });
            });

            $(document).on('submit', '#add-member-form', function (e) {
                e.preventDefault();
                $.ajax({
                    url: '/Admin/AddMember',
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function (result) {
                        if (result.success) {
                            alert('Üye baþarýyla eklendi!');
                            loadPage('ListMembers');
                        } else {
                            alert('Bir hata oluþtu: ' + result.errors);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error("Bir hata oluþtu: ", error);
                    }
                });
            });

            $(document).on('submit', '#edit-member-form', function (e) {
                e.preventDefault();
                $.ajax({
                    url: '/Admin/Edit',
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function (result) {
                        if (result.success) {
                            alert('Üye baþarýyla güncellendi!');
                            loadPage('ListMembers');
                        } else {
                            alert('Bir hata oluþtu: ' + result.errors);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error("Bir hata oluþtu: ", error);
                    }
                });
            });

            $(document).on('submit', '#delete-member-form', function (e) {
                e.preventDefault();
                $.ajax({
                    url: '/Admin/DeleteConfirmed',
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function (result) {
                        if (result.success) {
                            alert('Üye baþarýyla silindi!');
                            loadPage('ListMembers');
                        } else {
                            alert('Bir hata oluþtu: ' + result.errors);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error("Bir hata oluþtu: ", error);
                    }
                });
            });

            $(document).on('submit', '#set-role-form', function (e) {
                e.preventDefault();
                $.ajax({
                    url: '/Admin/SetMemberRole',
                    type: 'POST',
                    data: $(this).serialize(),
                    success: function (result) {
                        if (result.success) {
                            alert('Rol baþarýyla güncellendi!');
                        } else {
                            alert('Bir hata oluþtu: ' + result.errors);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error("Bir hata oluþtu: ", error);
                    }
                });
            });
        });
    </script>
</body>
</html>
